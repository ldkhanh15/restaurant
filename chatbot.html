<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chatbot M·∫Øm C√¥ Ri Hu·∫ø</title>
<link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght=400;700&amp;family=Roboto:wght=300;400;500&amp;display=swap"
    rel="stylesheet">
<style>
    /* ƒê·∫∑t l·∫°i c√°c thi·∫øt l·∫≠p c∆° b·∫£n */
    html, body {
        font-family: 'Roboto', sans-serif;
        margin: 0;
        padding: 0;
        background: #f8f5f2;
        position: relative;
        /* ƒê·∫£m b·∫£o kh√¥ng c√≥ transform ·∫£nh h∆∞·ªüng ƒë·∫øn fixed elements */
    }

    /* ƒê·∫£m b·∫£o kh√¥ng c√≥ container n√†o ·∫£nh h∆∞·ªüng ƒë·∫øn FAB */
    * {
        box-sizing: border-box;
    }

    /* N√∫t tr√≤n k√≠ch ho·∫°t (Floating Action Button) - Lu√¥n ·ªü g√≥c d∆∞·ªõi b√™n ph·∫£i */
    #chat-fab {
        position: fixed !important;
        bottom: 20px !important;
        right: 20px !important;
        left: auto !important;
        top: auto !important;
        width: 64px;
        height: 64px;
        border-radius: 50%;
        background: linear-gradient(135deg, #8b5e3c 0%, #8b5e3c 50%, #8b5e3c 100%);
        color: white;
        border: 3px solid rgba(255, 255, 255, 0.3);
        cursor: pointer;
        z-index: 9999 !important;
        box-shadow: 0 8px 25px rgba(74, 144, 226, 0.4), 
                    0 0 0 0 rgba(74, 144, 226, 0.7),
                    inset 0 2px 4px rgba(255, 255, 255, 0.2);
        font-size: 28px;
        text-align: center;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 !important;
        padding: 0 !important;
        transform: none !important;
        overflow: visible;
    }

    /* Hi·ªáu ·ª©ng ripple xanh */
    #chat-fab::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(74, 144, 226, 0.4) 0%, rgba(74, 144, 226, 0) 70%);
        transform: translate(-50%, -50%) scale(1);
        animation: ripple 2s ease-out infinite;
        pointer-events: none;
    }

    /* Sparkle particles */
    #chat-fab .sparkle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: white;
        border-radius: 50%;
        pointer-events: none;
        animation: sparkle 2s ease-in-out infinite;
    }

    #chat-fab:hover {
        transform: scale(1.15) rotate(10deg) translateY(-3px) translateX(0) !important;
        box-shadow: 0 15px 45px rgba(74, 144, 226, 0.6),
                    0 0 30px rgba(74, 144, 226, 0.5),
                    inset 0 2px 4px rgba(255, 255, 255, 0.3);
        border-color: rgba(255, 255, 255, 0.5);
        animation-play-state: paused;
        position: fixed !important;
        bottom: 20px !important;
        right: 20px !important;
    }

    #chat-fab:active {
        transform: scale(1.05) rotate(5deg) translateY(0) translateX(0) !important;
        position: fixed !important;
        bottom: 20px !important;
        right: 20px !important;
    }

    /* Notification badge - lu√¥n hi·ªÉn th·ªã */
    #chat-fab::after {
        content: '';
        position: absolute;
        top: -2px;
        right: -2px;
        width: 14px;
        height: 14px;
        background: #15812a;
        border-radius: 50%;
        border: 2px solid white;
        animation: badgePulse 1.5s ease-in-out infinite;
        box-shadow: 0 2px 8px rgba(255, 68, 68, 0.4);
        display: block;
    }

    /* Icon t√¥m/m·∫Øm */
    #chat-fab span {
        display: block;
        font-size: 26px;
        transition: opacity 0.3s;
    }

    /* ·∫®N N√öT FAB KHI CHATBOT ƒêANG M·ªû */
    #chat-fab.hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        animation: none;
    }

    #chat-fab.hidden::before,
    #chat-fab.hidden::after {
        display: none;
    }


    /* Container ch√≠nh c·ªßa Chatbot */
    #chat-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 360px;
        height: 500px;
        background: #8b5e3c;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(74, 144, 226, 0.2), 
                    0 8px 25px rgba(0, 0, 0, 0.1),
                    0 0 0 1px rgba(74, 144, 226, 0.1);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        z-index: 1000;
        transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        border: 1px solid rgba(74, 144, 226, 0.15);
        opacity: 1;
        visibility: visible;
        transform: scale(1);
    }

    /* Tr·∫°ng th√°i ·∫©n/ƒë√≥ng */
    #chat-container.closed {
        opacity: 0;
        visibility: hidden;
        transform: scale(0.8) translateY(20px);
        pointer-events: none;
    }

    /* Header Chatbot v·ªõi m√†u xanh */
    #chat-header {
        background: linear-gradient(135deg, #8b5e3c 0%, #8b5e3c 50%, #8b5e3c 100%);
        color: #fffdf0;
        padding: 16px 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: 'Playfair Display', serif;
        font-weight: 700;
        position: relative;
        overflow: hidden;
        flex-shrink: 0;
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        box-shadow: 0 2px 10px rgba(74, 144, 226, 0.2);
    }

    #chat-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><defs><pattern id="grain" width="100" height="20" patternUnits="userSpaceOnUse"><circle cx="5" cy="5" r="1" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="20" fill="url(%23grain)"/></svg>');
        opacity: 0.05;
    }

    #chat-header h4 {
        margin: 0;
        font-size: 16px;
        z-index: 1;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    #chat-header .bot-avatar {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: radial-gradient(circle, #FFD700, #FFA500);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        margin-right: 10px;
        box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        z-index: 1;
    }

    /* N√∫t ƒê√≥ng */
    #close-btn {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 20px;
        cursor: pointer;
        padding: 4px 10px;
        border-radius: 50%;
        transition: background 0.3s, transform 0.2s;
        backdrop-filter: blur(10px);
        flex-shrink: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
    }

    #close-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
    }

    /* V√πng tin nh·∫Øn */
    #chat-messages {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        background: #f5f3f0;
        scrollbar-width: thin;
        scrollbar-color: #8b5e3c #f0f0f0;
    }

    #chat-messages::-webkit-scrollbar {
        width: 6px;
    }

    #chat-messages::-webkit-scrollbar-track {
        background: #f0f0f0;
        border-radius: 10px;
    }

    #chat-messages::-webkit-scrollbar-thumb {
        background: #8b5e3c;
        border-radius: 10px;
    }

    /* Bong b√≥ng tin nh·∫Øn v√† Markdown Styling (gi·ªØ nguy√™n) */
    .message {
        margin-bottom: 16px;
        display: flex;
        align-items: flex-end;
        opacity: 0;
        animation: fadeInUp 0.4s ease forwards;
    }

    .message.user {
        justify-content: flex-end;
    }

    .message.bot {
        justify-content: flex-start;
    }

    .message-bubble {
        max-width: 75%;
        padding: 12px 16px;
        border-radius: 18px;
        word-wrap: break-word;
        position: relative;
        font-weight: 400;
        line-height: 1.4;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        font-size: 14px;
        text-align: left;
    }

    .message.user .message-bubble {
        background: linear-gradient(135deg, #8b5e3c, #8b5e3c);
        color: white;
        border-bottom-right-radius: 4px;
    }

    .message.bot .message-bubble {
        background: white;
        color: #4a4a4a;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        border-bottom-left-radius: 4px;
        text-align: left;
    }

    .bot-avatar-small {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: radial-gradient(circle, #FFD700, #FFA500);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        margin-right: 8px;
        flex-shrink: 0;
    }

    .message.bot .message-bubble strong {
        color: #8b5e3c;
        font-weight: 700;
    }

    .message.bot .message-bubble ul,
    .message.bot .message-bubble ol {
        margin: 10px 0 0 15px;
        padding: 0;
        list-style-position: outside;
    }

    .message.bot .message-bubble li {
        margin-bottom: 5px;
        line-height: 1.5;
    }

    .message.bot .message-bubble a {
        color: #8b5e3c;
        text-decoration: none;
        font-weight: 500;
    }

    .message.bot .message-bubble p {
        margin: 0 0 10px 0;
    }

    .message.bot .message-bubble p:last-child {
        margin-bottom: 0;
    }

    /* Input v√† n√∫t g·ª≠i */
    #chat-input-container {
        padding: 12px 16px;
        background: white;
        border-top: 1px solid rgba(74, 144, 226, 0.15);
        position: relative;
        display: flex;
        align-items: flex-end;
        box-sizing: border-box;
        flex-shrink: 0;
    }

    #chat-input {
        flex-grow: 1;
        padding: 8px 14px;
        border: 1px solid #e0e0e0;
        border-radius: 18px;
        outline: none;
        resize: none;
        font-family: inherit;
        font-size: 13px;
        transition: border-color 0.3s, box-shadow 0.3s;
        background: #fafafa;
        min-height: 36px;
        box-sizing: border-box;
        margin-right: 8px;
        line-height: 1.4;
    }

    #chat-input:focus {
        border-color: #8b5e3c;
        box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
        background: white;
    }

    #chat-send {
        background: linear-gradient(135deg, #8b5e3c, #8b5e3c);
        color: white;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        min-width: 36px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        box-shadow: 0 4px 12px rgba(74, 144, 226, 0.4);
        line-height: 1;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }

    #chat-send svg {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(45deg);
        margin: 0;
        width: 18px;
        height: 18px;
    }

    #chat-send:hover:not(:disabled) {
        transform: scale(1.1) rotate(5deg);
        box-shadow: 0 6px 20px rgba(74, 144, 226, 0.6),
                    0 0 15px rgba(74, 144, 226, 0.4);
        background: linear-gradient(135deg, #8b5e3c, #8b5e3c);
    }

    #chat-send:hover:not(:disabled) svg {
        transform: translate(-50%, -50%) rotate(45deg);
    }

    #chat-send:disabled {
        background: #ccc;
        cursor: not-allowed;
        box-shadow: none;
    }

    /* Hi·ªáu ·ª©ng g√µ v√† animation (gi·ªØ nguy√™n) */
    .typing {
        font-style: italic;
        color: #888;
        display: flex;
        align-items: center;
    }

    .typing-dots {
        display: inline-flex;
        margin-left: 5px;
    }

    .typing-dots span {
        display: inline-block;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: #8b5e3c;
        margin: 0 2px;
        animation: typing 1.4s infinite ease-in-out;
    }

    .typing-dots span:nth-child(2) {
        animation-delay: 0.2s;
    }

    .typing-dots span:nth-child(3) {
        animation-delay: 0.4s;
    }

    @keyframes typing {

        0%,
        60%,
        100% {
            transform: translateY(0);
        }

        30% {
            transform: translateY(-4px);
        }
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Hi·ªáu ·ª©ng entrance cho FAB v·ªõi bounce m·∫°nh h∆°n - ch·ªâ transform, kh√¥ng thay ƒë·ªïi position fixed */
    @keyframes fabEntrance {
        0% {
            opacity: 0;
            transform: scale(0) translateY(80px) translateX(0) rotate(-360deg);
        }
        40% {
            opacity: 1;
            transform: scale(1.2) translateY(-10px) translateX(0) rotate(15deg);
        }
        60% {
            transform: scale(0.95) translateY(5px) translateX(0) rotate(-5deg);
        }
        80% {
            transform: scale(1.05) translateY(-2px) translateX(0) rotate(2deg);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateY(0) translateX(0) rotate(0deg);
        }
    }

    /* Hi·ªáu ·ª©ng pulse cho FAB v·ªõi m√†u xanh - ch·ªâ scale, gi·ªØ nguy√™n position */
    @keyframes fabPulse {
        0%, 100% {
            transform: scale(1) translateY(0) translateX(0);
            box-shadow: 0 8px 25px rgba(74, 144, 226, 0.4),
                        0 0 0 0 rgba(74, 144, 226, 0.7);
        }
        50% {
            transform: scale(1.08) translateY(0) translateX(0);
            box-shadow: 0 12px 35px rgba(74, 144, 226, 0.6),
                        0 0 0 8px rgba(74, 144, 226, 0);
        }
    }

    /* Hi·ªáu ·ª©ng glow */
    @keyframes fabGlow {
        0%, 100% {
            filter: drop-shadow(0 0 5px rgba(74, 144, 226, 0.5));
        }
        50% {
            filter: drop-shadow(0 0 15px rgba(74, 144, 226, 0.8)) 
                    drop-shadow(0 0 25px rgba(74, 144, 226, 0.4));
        }
    }

    /* Hi·ªáu ·ª©ng ripple xanh */
    @keyframes ripple {
        0% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 0.6;
        }
        100% {
            transform: translate(-50%, -50%) scale(2);
            opacity: 0;
        }
    }

    /* Hi·ªáu ·ª©ng sparkle */
    @keyframes sparkle {
        0%, 100% {
            opacity: 0;
            transform: scale(0) translate(0, 0);
        }
        50% {
            opacity: 1;
            transform: scale(1) translate(var(--sparkle-x), var(--sparkle-y));
        }
    }

    /* Hi·ªáu ·ª©ng pulse cho notification badge */
    @keyframes badgePulse {
        0%, 100% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.2);
            opacity: 0.8;
        }
    }

    /* Hi·ªáu ·ª©ng bounce khi m·ªü chatbot */
    @keyframes chatBounce {
        0% {
            transform: scale(0.8) translateY(20px);
            opacity: 0;
        }
        50% {
            transform: scale(1.05) translateY(-5px);
        }
        100% {
            transform: scale(1) translateY(0);
            opacity: 1;
        }
    }

    /* Hi·ªáu ·ª©ng shake ƒë·ªÉ thu h√∫t ch√∫ √Ω */
    @keyframes shake {
        0%, 100% {
            transform: translateX(0);
        }
        10%, 30%, 50%, 70%, 90% {
            transform: translateX(-3px) rotate(-2deg);
        }
        20%, 40%, 60%, 80% {
            transform: translateX(3px) rotate(2deg);
        }
    }

    /* Class ƒë·ªÉ k√≠ch ho·∫°t shake */
    #chat-fab.shake {
        animation: shake 0.5s ease-in-out, fabPulse 2s ease-in-out infinite 0.5s;
    }

    /* Hi·ªáu ·ª©ng khi chatbot m·ªü */
    #chat-container:not(.closed) {
        animation: chatBounce 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    /* Hi·ªáu ·ª©ng ripple khi click v·ªõi m√†u xanh */
    @keyframes rippleClick {
        0% {
            transform: scale(0);
            opacity: 1;
        }
        100% {
            transform: scale(2.5);
            opacity: 0;
        }
    }

    /* Hi·ªáu ·ª©ng floating cho FAB - ch·ªâ transform, kh√¥ng ·∫£nh h∆∞·ªüng position fixed */
    @keyframes floating {
        0%, 100% {
            transform: translateY(0) translateX(0);
        }
        50% {
            transform: translateY(-8px) translateX(0);
        }
    }

    /* Th√™m floating animation sau entrance - ƒë·∫£m b·∫£o position fixed kh√¥ng b·ªã ·∫£nh h∆∞·ªüng */
    #chat-fab:not(.hidden) {
        position: fixed !important;
        animation: fabEntrance 0.8s cubic-bezier(0.34, 1.56, 0.64, 1),
                   fabPulse 2s ease-in-out infinite,
                   fabGlow 2s ease-in-out infinite,
                   floating 3s ease-in-out infinite;
        animation-delay: 0s, 0.8s, 0.5s, 1.5s;
        animation-fill-mode: forwards, none, none, none;
    }
</style>



<button id="chat-fab" title="M·ªü Chatbot M·∫Øm C√¥ Ri">
    <span>üç§</span>
</button>

<div id="chat-container" class="closed">
    <div id="chat-header">
        <div style="display: flex; align-items: center;">
            <div class="bot-avatar">üç§</div>
            <h4>Chat v·ªõi C√¥ Ri Bot</h4>
        </div>
        <button id="close-btn" title="ƒê√≥ng c·ª≠a s·ªï">√ó</button>
    </div>
    <div id="chat-messages">
    </div>
    <div id="chat-input-container">
        <textarea id="chat-input" placeholder="Xin ch√†o!" rows="1"></textarea>
        <button id="chat-send" title="G·ª≠i tin nh·∫Øn">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="22" y1="2" x2="11" y2="13"></line>
                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
        </button>
    </div>
</div>

<script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    // VUI L√íNG THAY TH·∫æ CHU·ªñI N√ÄY B·∫∞NG API KEY C·ª¶A B·∫†N
    const genAI = new GoogleGenerativeAI("AIzaSyCO7ilZ2D2STXjHX_Gel1Nyplz5AJ3sLSY");

    // Context/Persona - Ng·ªØ ƒëi·ªáu trang tr·ªçng, kh√¥ng gi·ªçng Hu·∫ø
    const context = `
B·∫°n l√† C√¥ Ri Bot, tr·ª£ l√Ω t∆∞ v·∫•n chuy√™n nghi·ªáp v√† l·ªãch s·ª± cho c·ª≠a h√†ng M·∫Øm C√¥ Ri - ƒê·∫∑c s·∫£n danh ti·∫øng x·ª© Hu·∫ø. C·ª≠a h√†ng ƒë∆∞·ª£c th√†nh l·∫≠p t·ª´ nh·ªØng nƒÉm 1990, v·ªõi h∆°n 30 nƒÉm kinh nghi·ªám, l√† m·ªôt trong nh·ªØng th∆∞∆°ng hi·ªáu m·∫Øm l√¢u ƒë·ªùi v√† uy t√≠n nh·∫•t t·∫°i Hu·∫ø. Ch√∫ng t√¥i chuy√™n s·∫£n xu·∫•t m·∫Øm truy·ªÅn th·ªëng t·ª´ nguy√™n li·ªáu t∆∞∆°i ngon, s·∫°ch s·∫Ω, kh√¥ng s·ª≠ d·ª•ng ch·∫•t b·∫£o qu·∫£n.

NGUY√äN T·∫ÆC QUAN TR·ªåNG:
1. S·ª¨ D·ª§NG NG·ªÆ ƒêI·ªÜU TRANG TR·ªåNG, L·ªäCH S·ª∞, CHUY√äN NGHI·ªÜP. Kh√¥ng s·ª≠ d·ª•ng gi·ªçng Hu·∫ø, kh√¥ng d√πng t·ª´ "·∫°", "r·ª©a", "nh·ªâ", "mi·ªÅn". S·ª≠ d·ª•ng ng√¥n ng·ªØ ph·ªï th√¥ng, l·ªãch s·ª±, chuy√™n nghi·ªáp.
2. TUY·ªÜT ƒê·ªêI KH√îNG ƒê∆Ø·ª¢C N√äU GI√Å C·ª§ TH·ªÇ C·ª¶A B·∫§T K·ª≤ S·∫¢N PH·∫®M N√ÄO.
3. T·∫≠p trung v√†o T∆Ø V·∫§N CHUY√äN NGHI·ªÜP, THUY·∫æT PH·ª§C kh√°ch h√†ng l·ª±a ch·ªçn M·∫Øm C√¥ Ri b·∫±ng c√°ch:
    - Nh·∫•n m·∫°nh CH·∫§T L∆Ø·ª¢NG: Nguy√™n li·ªáu t∆∞∆°i ngon, s·∫°ch s·∫Ω, kh√¥ng ch·∫•t b·∫£o qu·∫£n, quy tr√¨nh truy·ªÅn th·ªëng ƒë∆∞·ª£c ki·ªÉm so√°t ch·∫∑t ch·∫Ω.
    - Nh·∫•n m·∫°nh L·ªäCH S·ª¨ V√Ä UY T√çN: H∆°n 30 nƒÉm kinh nghi·ªám, th∆∞∆°ng hi·ªáu l√¢u ƒë·ªùi nh·∫•t Hu·∫ø, ƒë∆∞·ª£c nhi·ªÅu th·∫ø h·ªá kh√°ch h√†ng tin t∆∞·ªüng.
    - G·ª£i √Ω m√≥n ƒÉn, c√¥ng th·ª©c pha ch·∫ø chuy√™n nghi·ªáp v√† ƒë·ªôc ƒë√°o.
    - ƒê·ªÅ xu·∫•t combo s·∫£n ph·∫©m ph√π h·ª£p v·ªõi nhu c·∫ßu kh√°ch h√†ng.
    - N·∫øu kh√°ch h·ªèi gi√°, h√£y tr·∫£ l·ªùi m·ªôt c√°ch l·ªãch s·ª± v√† chuy√™n nghi·ªáp: "ƒê·ªÉ ƒë∆∞·ª£c b√°o gi√° ch√≠nh x√°c nh·∫•t v√† c√°c ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i hi·ªán h√†nh, Qu√Ω kh√°ch vui l√≤ng li√™n h·ªá tr·ª±c ti·∫øp qua Zalo/Hotline ho·∫∑c Facebook M·∫Øm C√¥ Ri - ƒê·∫∑c s·∫£n danh ti·∫øng x·ª© Hu·∫ø. Ch√∫ng t√¥i cam k·∫øt s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng cao, x·ª©ng ƒë√°ng v·ªõi gi√° tr·ªã m√† Qu√Ω kh√°ch ƒë·∫ßu t∆∞."

TH√îNG TIN C·ª¨A H√ÄNG:
- ƒê·ªãa ch·ªâ s·∫£n xu·∫•t: La ·ª∂, Ph∆∞·ªùng Ph√∫ Th∆∞·ª£ng, Th√†nh ph·ªë Hu·∫ø. ƒêi·ªán tho·∫°i: 0234.3999929.
- Qu·∫ßy b√°n ch√≠nh: S·ªë 06 Tr·∫ßn H∆∞ng ƒê·∫°o (b√£i ƒë·ªï xe Si√™u th·ªã Coop Mart, Th√†nh ph·ªë Hu·∫ø).
- Chi nh√°nh: L·∫ßu E, ch·ª£ ƒê√¥ng Ba - 0234.3531076 / 037.377.2159.
- Facebook: M·∫Øm C√¥ Ri - ƒê·∫∑c s·∫£n danh ti·∫øng x·ª© Hu·∫ø.
- Giao h√†ng to√†n qu·ªëc qua Shopee, c√°c shop ƒë·∫∑c s·∫£n Hu·∫ø, v√† ƒë·∫°i l√Ω t·∫°i TP.HCM.

DANH M·ª§C S·∫¢N PH·∫®M CHI TI·∫æT:

1. M·∫ÆM N√äM C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: V·ªã ƒë·∫≠m ƒë√†, th∆°m ngon, ƒë∆∞·ª£c ·ªß t·ª´ c√° c∆°m t∆∞∆°i ngon theo c√¥ng th·ª©c truy·ªÅn th·ªëng.
   - C√¥ng d·ª•ng: D√πng ƒë·ªÉ pha n∆∞·ªõc ch·∫•m, ch·∫•m g·ªèi cu·ªën, th·ªãt lu·ªôc, b√≤ n∆∞·ªõng l√° l·ªët, c√°c m√≥n n∆∞·ªõng.
   - C√°ch pha ch·∫•m: M·∫Øm n√™m + n∆∞·ªõc c·ªët d·ª©a/th∆°m + n∆∞·ªõc c·ªët chanh + ƒë∆∞·ªùng + t·ªèi ·ªõt bƒÉm nhuy·ªÖn. C√≥ th·ªÉ th√™m n∆∞·ªõc d·ª´a ƒë·ªÉ tƒÉng ƒë·ªô ng·ªçt t·ª± nhi√™n.
   - B·∫£o qu·∫£n: ƒê·ªÉ n∆°i kh√¥ r√°o, tho√°ng m√°t, tr√°nh √°nh n·∫Øng tr·ª±c ti·∫øp.

2. M·∫ÆM C√Å R√í C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: Th∆°m ƒë·∫≠m ƒë√†, v·ªã ƒë·∫Øng m·∫≠t c√° ƒë·∫∑c tr∆∞ng, l√† ƒë·∫∑c s·∫£n ƒë·ªôc ƒë√°o c·ªßa v√πng Hu·∫ø.
   - C√¥ng d·ª•ng: Ch·∫•m v·ªõi th·ªãt lu·ªôc, g·ªèi, c√°c m√≥n n∆∞·ªõng. C√≥ th·ªÉ d√πng ƒë·ªÉ kho c√°, kho th·ªãt.
   - ƒê·∫∑c bi·ªát: V·ªã ƒë·∫Øng m·∫≠t c√° t·∫°o n√™n h∆∞∆°ng v·ªã ƒë·∫∑c tr∆∞ng, kh√≥ qu√™n.

3. M·∫ÆM RU·ªêC C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: M·ªãn m√†ng, th∆°m ngon, ƒë∆∞·ª£c l√†m t·ª´ ru·ªëc t∆∞∆°i ngon.
   - C√¥ng d·ª•ng: Pha n∆∞·ªõc ch·∫•m, l√†m n∆∞·ªõc s·ªët cho c√°c m√≥n n∆∞·ªõng, kho.
   - ∆Øu ƒëi·ªÉm: K·∫øt c·∫•u m·ªãn, d·ªÖ pha ch·∫ø, ph√π h·ª£p v·ªõi nhi·ªÅu m√≥n ƒÉn.

4. M·∫ÆM T√îM CHUA C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: V·ªã chua ng·ªçt h√†i h√≤a, th∆°m m√πi t√¥m t∆∞∆°i.
   - C√¥ng d·ª•ng: Ch·∫•m g·ªèi cu·ªën, b√°nh tr√°ng, th·ªãt lu·ªôc. C√≥ th·ªÉ d√πng l√†m n∆∞·ªõc s·ªët.
   - ƒê·∫∑c bi·ªát: V·ªã chua ng·ªçt t·ª± nhi√™n, kh√¥ng qu√° g·∫Øt.

5. M·∫ÆM C√Ä C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: ƒê∆∞·ª£c l√†m t·ª´ c√† ph√°o t∆∞∆°i, v·ªã ƒë·∫≠m ƒë√†.
   - C√¥ng d·ª•ng: ƒÇn k√®m v·ªõi c∆°m, ch√°o, ho·∫∑c c√°c m√≥n m·∫∑n.

6. M·∫ÆM C√Ä PH√ÅO C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: Gi√≤n tan, v·ªã chua ng·ªçt, th∆°m ngon.
   - C√¥ng d·ª•ng: ƒÇn k√®m v·ªõi c∆°m, ch√°o, ho·∫∑c l√†m m√≥n nh·∫≠u.
   - ∆Øu ƒëi·ªÉm: ƒê·ªô gi√≤n ƒë·∫∑c tr∆∞ng, t·∫°o c·∫£m gi√°c th√∫ v·ªã khi ƒÉn.

7. C√Å C∆†M RIM C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: Rim m·∫≠t ong cay, v·ªã ng·ªçt ƒë·∫≠m ƒë√†, cay nh·∫π.
   - C√¥ng d·ª•ng: ƒÇn k√®m v·ªõi c∆°m, ch√°o, ho·∫∑c l√†m m√≥n nh·∫≠u.
   - ƒê·∫∑c bi·ªát: C√¥ng th·ª©c rim m·∫≠t ong ƒë·ªôc ƒë√°o, t·∫°o h∆∞∆°ng v·ªã ƒë·∫∑c bi·ªát.

8. D∆ØA M√ìN HU·∫æ C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: V·ªã chua ng·ªçt h√†i h√≤a, gi√≤n, th∆°m m√πi gia v·ªã Hu·∫ø.
   - C√¥ng d·ª•ng: ƒÇn k√®m v·ªõi c∆°m, ch√°o, c√°c m√≥n m·∫∑n. L√†m m√≥n khai v·ªã.
   - Th√†nh ph·∫ßn: C√°c lo·∫°i rau c·ªß ƒë∆∞·ª£c mu·ªëi chua theo c√¥ng th·ª©c truy·ªÅn th·ªëng Hu·∫ø.

9. T√îM CHUA C√î RI:
   - ƒê·∫∑c ƒëi·ªÉm: T√¥m t∆∞∆°i ƒë∆∞·ª£c mu·ªëi chua, v·ªã chua ng·ªçt t·ª± nhi√™n.
   - C√¥ng d·ª•ng: ƒÇn k√®m v·ªõi c∆°m, ch√°o, ho·∫∑c l√†m m√≥n nh·∫≠u.
   - ∆Øu ƒëi·ªÉm: T√¥m t∆∞∆°i, v·ªã chua ng·ªçt h√†i h√≤a, kh√¥ng qu√° g·∫Øt.

C√ÅCH S·ª¨ D·ª§NG V√Ä B·∫¢O QU·∫¢N:
- Pha ch·∫•m c∆° b·∫£n: M·∫Øm + n∆∞·ªõc c·ªët d·ª©a/th∆°m + n∆∞·ªõc c·ªët chanh + ƒë∆∞·ªùng + t·ªèi ·ªõt bƒÉm nhuy·ªÖn. C√≥ th·ªÉ th√™m n∆∞·ªõc d·ª´a ƒë·ªÉ tƒÉng ƒë·ªô ng·ªçt t·ª± nhi√™n.
- M·∫πo pha ch·∫ø: Kh√¥ng pha n∆∞·ªõc l·∫°nh; d√πng n∆∞·ªõc d·ª´a ho·∫∑c n∆∞·ªõc d·ª©a ·∫•m. ƒêun s√¥i m·∫Øm tr∆∞·ªõc n·∫øu mu·ªën kh·ª≠ tanh. Th√™m t·ªèi ·ªõt t∆∞∆°i ngay tr∆∞·ªõc khi d√πng ƒë·ªÉ tƒÉng h∆∞∆°ng v·ªã.
- B·∫£o qu·∫£n: ƒê·ªÉ n∆°i kh√¥ r√°o, tho√°ng m√°t, tr√°nh √°nh n·∫Øng tr·ª±c ti·∫øp. Sau khi m·ªü n·∫Øp, n√™n b·∫£o qu·∫£n trong t·ªß l·∫°nh v√† s·ª≠ d·ª•ng trong th·ªùi gian h·ª£p l√Ω.
- M√≥n ƒÉn k√®m: G·ªèi cu·ªën, th·ªãt lu·ªôc, b√≤ n∆∞·ªõng l√° l·ªët, c√°c m√≥n n∆∞·ªõng, c∆°m, ch√°o.

COMBO S·∫¢N PH·∫®M ƒê·ªÄ XU·∫§T:
- Combo 1: M·∫Øm n√™m + D∆∞a m√≥n Hu·∫ø (ph√π h·ª£p cho gia ƒë√¨nh)
- Combo 2: M·∫Øm c√° r√≤ + M·∫Øm ru·ªëc (cho ng∆∞·ªùi y√™u th√≠ch h∆∞∆°ng v·ªã ƒë·∫≠m ƒë√†)
- Combo 3: M·∫Øm t√¥m chua + T√¥m chua (cho ng∆∞·ªùi th√≠ch v·ªã chua ng·ªçt)
- Combo 4: C√° c∆°m rim + D∆∞a m√≥n (combo ƒëa d·∫°ng)
`;

    async function askGemini(prompt) {
        const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });
        const fullPrompt = context + "\n\nNg∆∞·ªùi d√πng: " + prompt + "\nC√¥ Ri Bot:";

        // T·∫°o m·ªôt request ch·∫∑n gi√° v·ªõi ng·ªØ ƒëi·ªáu trang tr·ªçng
        if (prompt.toLowerCase().includes('gi√°') || prompt.toLowerCase().includes('bao nhi√™u') || prompt.toLowerCase().includes('vnd') || prompt.toLowerCase().includes('ti·ªÅn') || prompt.toLowerCase().includes('cost') || prompt.toLowerCase().includes('price')) {
            return "ƒê·ªÉ ƒë∆∞·ª£c b√°o **gi√° ∆∞u ƒë√£i** v√† ch√≠nh s√°ch v·∫≠n chuy·ªÉn ch√≠nh x√°c nh·∫•t, Qu√Ω kh√°ch vui l√≤ng li√™n h·ªá tr·ª±c ti·∫øp qua Zalo/Hotline ho·∫∑c Facebook M·∫Øm C√¥ Ri - ƒê·∫∑c s·∫£n danh ti·∫øng x·ª© Hu·∫ø. Ch√∫ng t√¥i cam k·∫øt s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng cao, x·ª©ng ƒë√°ng v·ªõi gi√° tr·ªã m√† Qu√Ω kh√°ch ƒë·∫ßu t∆∞.";
        }

        const result = await model.generateContent(fullPrompt);
        return await result.response.text();
    }

    // H√†m chuy·ªÉn ƒë·ªïi Markdown sang HTML c∆° b·∫£n (Gi·ªØ nguy√™n)
    function markdownToHtml(markdown) {
        let html = markdown;
        html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        html = html.replace(/^\s*\*\s+(.*)$/gm, '<li>$1</li>');
        if (html.includes('<li>')) {
            html = `<ul>${html}</ul>`;
            html = html.replace(/<\/ul>\s*<ul>/g, '');
        }
        html = html.replace(/\n\n/g, '</p><p>');
        html = html.replace(/\n/g, '<br>');
        html = `<p>${html}</p>`;

        html = html.replace(/<p><\/p>/g, '');
        html = html.replace(/<p>\s*<ul>/g, '<ul>');
        html = html.replace(/<\/ul>\s*<\/p>/g, '</ul>');

        return html;
    }

    document.addEventListener("DOMContentLoaded", () => {
        const chatContainer = document.getElementById("chat-container");
        const messagesEl = document.getElementById("chat-messages");
        const inputEl = document.getElementById("chat-input");
        const sendBtn = document.getElementById("chat-send");
        const closeBtn = document.getElementById("close-btn");
        const chatFab = document.getElementById("chat-fab");

        // Bi·∫øn ƒë·ªÉ theo d√µi notification
        let hasNewMessage = false;
        let isFirstLoad = true;

        // Hi·ªáu ·ª©ng shake sau khi load trang (ch·ªâ 1 l·∫ßn)
        setTimeout(() => {
            if (isFirstLoad && chatContainer.classList.contains('closed')) {
                chatFab.classList.add('shake');
                setTimeout(() => {
                    chatFab.classList.remove('shake');
                }, 500);
                isFirstLoad = false;
            }
        }, 1500);

        // Th√™m tin nh·∫Øn
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement("div");
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            let contentHtml = isUser ? text : markdownToHtml(text);

            if (isUser) {
                messageDiv.innerHTML = `<div class="message-bubble">${contentHtml}</div>`;
            } else {
                messageDiv.innerHTML = `
                    <div class="bot-avatar-small">üç§</div>
                    <div class="message-bubble">${contentHtml}</div>
                `;
            }
            messagesEl.appendChild(messageDiv);
            messagesEl.scrollTop = messagesEl.scrollHeight;

            // N·∫øu l√† tin nh·∫Øn bot v√† chatbot ƒëang ƒë√≥ng, hi·ªÉn th·ªã notification
            if (!isUser && chatContainer.classList.contains('closed')) {
                hasNewMessage = true;
                chatFab.classList.add('has-notification');
                // Th√™m hi·ªáu ·ª©ng shake ƒë·ªÉ thu h√∫t ch√∫ √Ω
                chatFab.classList.add('shake');
                setTimeout(() => {
                    chatFab.classList.remove('shake');
                }, 500);
            }
        }

        // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒëang g√µ
        function showTyping() {
            const typingDiv = document.createElement("div");
            typingDiv.className = "message bot typing";
            typingDiv.innerHTML = `
                <div class="bot-avatar-small">üç§</div>
                <div class="message-bubble">
                    C√¥ Ri Bot ƒëang t∆∞ v·∫•n cho b·∫°n... 
                    <div class="typing-dots">
                        <span></span><span></span><span></span>
                    </div>
                </div>
            `;
            messagesEl.appendChild(typingDiv);
            messagesEl.scrollTop = messagesEl.scrollHeight;
            return typingDiv;
        }

        // G·ª≠i tin nh·∫Øn
        async function sendMessage() {
            const q = inputEl.value.trim();
            if (!q) return;

            addMessage(q, true);
            inputEl.value = "";
            inputEl.style.height = "auto";

            const typingEl = showTyping();
            try {
                const response = await askGemini(q);
                messagesEl.removeChild(typingEl);
                addMessage(response, false);
            } catch (error) {
                console.error("L·ªói:", error);
                messagesEl.removeChild(typingEl);
                addMessage("·ªêi z·ªùi ∆°i, c√≥ l·ªói nh·ªè x√≠u trong l√∫c t∆∞ v·∫•n! Th·ª≠ l·∫°i nha b·∫°n. üòÖ", false);
            }
        }

        // Logic M·ªü/ƒê√≥ng Chatbot
        function openChat() {
            chatContainer.classList.remove("closed");
            chatFab.classList.add("hidden");
            messagesEl.scrollTop = messagesEl.scrollHeight;
            inputEl.focus();
            // X√≥a notification khi m·ªü chatbot
            hasNewMessage = false;
            chatFab.classList.remove('has-notification');
        }

        function closeChat() {
            chatContainer.classList.add("closed");
            chatFab.classList.remove("hidden");
            // N·∫øu c√≥ tin nh·∫Øn m·ªõi, hi·ªÉn th·ªã l·∫°i notification
            if (hasNewMessage) {
                chatFab.classList.add('has-notification');
            }
        }

        // T·∫°o sparkle particles
        function createSparkles() {
            if (chatFab.classList.contains('hidden')) return;
            
            const sparkleCount = 6;
            const angles = Array.from({ length: sparkleCount }, (_, i) => (360 / sparkleCount) * i);
            
            angles.forEach((angle, index) => {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                const radius = 35;
                const radian = (angle * Math.PI) / 180;
                const x = Math.cos(radian) * radius;
                const y = Math.sin(radian) * radius;
                
                sparkle.style.cssText = `
                    --sparkle-x: ${x}px;
                    --sparkle-y: ${y}px;
                    animation-delay: ${index * 0.1}s;
                    left: 50%;
                    top: 50%;
                `;
                
                chatFab.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 2000);
            });
        }

        // T·∫°o sparkles ƒë·ªãnh k·ª≥
        setInterval(createSparkles, 3000);

        // X·ª≠ l√Ω s·ª± ki·ªán cho FAB (M·ªü Chat) v·ªõi hi·ªáu ·ª©ng ripple v√† sparkles
        chatFab.onclick = (e) => {
            // T·∫°o hi·ªáu ·ª©ng ripple
            const ripple = document.createElement('span');
            const rect = chatFab.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                border-radius: 50%;
                background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, rgba(74, 144, 226, 0.3) 100%);
                left: ${x}px;
                top: ${y}px;
                pointer-events: none;
                animation: rippleClick 0.8s ease-out;
                z-index: 1;
            `;
            
            chatFab.appendChild(ripple);
            setTimeout(() => ripple.remove(), 800);
            
            // T·∫°o burst sparkles khi click
            createSparkles();
            
            openChat();
        };

        // X·ª≠ l√Ω s·ª± ki·ªán cho n√∫t ƒê√≥ng
        closeBtn.onclick = (e) => {
            e.stopPropagation();
            closeChat();
        };

        // G·ª≠i tin nh·∫Øn v√† auto-resize
        sendBtn.onclick = sendMessage;
        inputEl.onkeypress = (e) => {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        };

        // Auto-resize textarea
        inputEl.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Tin nh·∫Øn ch√†o m·ª´ng ban ƒë·∫ßu v·ªõi ng·ªØ ƒëi·ªáu trang tr·ªçng
        // Delay m·ªôt ch√∫t ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng t·ª± nhi√™n h∆°n
        setTimeout(() => {
            addMessage("Xin ch√†o Qu√Ω kh√°ch! T√¥i l√† C√¥ Ri Bot, tr·ª£ l√Ω t∆∞ v·∫•n c·ªßa M·∫Øm C√¥ Ri - ƒê·∫∑c s·∫£n danh ti·∫øng x·ª© Hu·∫ø v·ªõi h∆°n **30 nƒÉm kinh nghi·ªám**. Qu√Ω kh√°ch c√≥ th·ªÉ h·ªèi v·ªÅ c√°c s·∫£n ph·∫©m m·∫Øm, h∆∞∆°ng v·ªã, c√°ch pha ch·∫ø, ho·∫∑c ƒë·ªÉ t√¥i g·ª£i √Ω combo s·∫£n ph·∫©m ph√π h·ª£p. T√¥i s·∫µn s√†ng h·ªó tr·ª£ Qu√Ω kh√°ch! üòä", false);
        }, 800);
    });
</script>